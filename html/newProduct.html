{{ define "title" }}New Product{{ end }}
{{ define "content" }}
	<div>
		<form hx-post="/admin/products" enctype="multipart/form-data">
			<div class="mb-3">
				<label>Product Name</label>
				<input class="form-control" type="text" name="name">
			</div>
			<div class="mb-3">
				<label>Price</label>
				<input class="form-control" type="number" name="price" step=".01">
			</div>
			<div class="mb-3">
				<label>Description</label>
				<input class="form-control" type="textarea" name="description">
			</div>
			<div class="mb-3">
				<label>Category</label>
				<select class="form-control" name="category" id="category">
					<option value="Cutting Board">Cutting Board</option>
					<option value="Charcuterie Board">Charcuterie Board</option>
					<option value="Chopping Block">Chopping Block</option>
				</select>
			</div>
			{{ template "imageUpload" }}
			<button class="btn">Submit</button>
		</form>
	</div>
	<script>
		function displaySelectedImage(event, elementId) {
			const selectedImage = document.getElementById(elementId);
			const fileInput = event.target;
			
			console.log(event);
			
			if(fileInput.files && fileInput.files[0]) {
				const reader = new FileReader();
				
				reader.onload = function(e) {
					selectedImage.src = e.target.result;
				}

				reader.readAsDataURL(fileInput.files[0]);
			}
		}
	</script>
{{ end }}

<!-- TODO: Get multiple image uploads working --!>
{{ define "imageUpload" }}
	<div>
		<div class="mb-4 d-flex justify-content-center">
			<img src="https://mdbootstrap.com/img/Photos/Others/placeholder.jpg" alt="placeholder image" id="selectedImage"
			style="width:300px;" hx-trigger="changed" hx-get="/admin/newimage" hx-target="next"/>
		</div>
		<div class="d-flex justify-content-center">
			<div class="btn btn-primary btn-rounded">
				<label class="form-label text-white m-1" for="imageUpload">Choose file</label>
				<input class="form-control d-none" type="file" id="imageUpload" onchange="displaySelectedImage(event, 'selectedImage')" accept=".jpp,.jpeg,.png">
			</div>
		</div>
	</div>
	<div id="next"></div>
{{ end }}
